
	--  CREATE  CATEGORY_LIST,PRODUCTS,COUNTRY_TABLE AND JOIN 3 TABLES
	--  GITHUB CO-PILOT
	--  AZURE DATA STUDIO IS ALMOST VISUAL STUDIO CODE
	--  UK ENGLAND --- FIREWALL --AMSTERDAM
	--  FOUNDER OF MS SQL SERVER
	--  INSURANCE
	--  IS THIS POSSIBLE TO PUSH CODES IN GITHUB FROM MS SQL SERVER



	CREATE TABLE CATEGORY_LIST
	 (
	 CATG_ID INT PRIMARY KEY,
	 CATEGORY_NAME VARCHAR(25)
	 );

	 --DROP TABLE CATEGORY_LIST;

	 INSERT INTO CATEGORY_LIST (CATG_ID,CATEGORY_NAME)
	 VALUES
	 (1,'Beauty products'),
	 (2,'Herbal products'),
	 (3,'Medical products');

	 select * from CATEGORY_LIST;

    ---- JOINS  BEAUTY_PRODUCTS  ----

	CREATE TABLE PRODUCTS(
	PRO_ID INT,
	PRO_NAME VARCHAR(25),
	PRO_PRICE DECIMAL (8,3),
	CATEGORY_ID INT,
	FOREIGN KEY (CATEGORY_ID) REFERENCES CATEGORY_LIST(CATG_ID)
	);

	INSERT INTO PRODUCTS (PRO_ID,PRO_NAME,PRO_PRICE,CATEGORY_ID)
	VALUES
	(01,'Moisturizing cream',150,1),
	(02,'Lipstick',150,1),
	(03,'Gold Mask',450,2),
	(04,'Amla Hair oil',180,2),
	(05,'Moisturizing cream',150,1),
	(06,'Patanjali juice',950,3),
	(07,'Neem Honey',840,2),
	(08,'Hand Santizer',100,3),
	(09,'Forest Honey',720,2),
	(10,'Fir Knee Band',1150,3),
	(11,'Fairness Face Wash',350,1),
	(12,'Kasturi Manjal Jel',250,1);

	SELECT * FROM PRODUCTS ORDER BY CATEGORY_ID ;

	SELECT * FROM CATEGORY_LIST;

	SELECT * FROM PRODUCTS;

	CREATE TABLE COUNTRY_TABLE
	(
	CID INT,
	CNAME VARCHAR(25),
	PRIMARY KEY(CID,CNAME)
	);

	INSERT INTO COUNTRY_TABLE(CID,CNAME)VALUES
	(91,'India'),
	(71,'Nepal'),
	(35,'Pakistan');

	select * from COUNTRY_TABLE;

	SELECT P.PRO_NAME,P.PRO_PRICE,C.CATEGORY_NAME
	FROM  PRODUCTS P
	INNER JOIN CATEGORY_LIST C
	ON P.CATEGORY_ID=C.CATG_ID WHERE C.CATG_ID=2

	ALTER VIEW TABLE_JOINS
	AS
    SELECT P.PRO_NAME,P.PRO_PRICE,C.CATEGORY_NAME
	FROM  PRODUCTS P 
	INNER JOIN CATEGORY_LIST C
	ON P.CATEGORY_ID=C.CATG_ID;

	SELECT * FROM CATEGORY_LIST;

	SELECT * FROM PRODUCTS;

	SELECT * FROM COUNTRY_TABLE;

	ALTER TABLE CATEGORY_LIST ADD
	COUNTRY VARCHAR(25)

	--ALTER TABLE CATEGORY_LIST DROP COLUMN COUNTRY;

	ALTER TABLE CATEGORY_LIST ADD CONSTRAINT fk_employee 
    FOREIGN KEY (CNTRY_NAME VARCHAR) REFERENCES COUNTRY_TABLE(CNAME);

	ALTER TABLE CATEGORY_LIST ADD CONSTRAINT fk_employee 
    FOREIGN KEY (CNTRY_NAME) REFERENCES COUNTRY_TABLE(CNAME);

	ALTER TABLE CATEGORY_LIST
    ADD COUNTRY VARCHAR(25)
    CONSTRAINT FK_Customer_Test_Drive 
    FOREIGN KEY (COUNTRY) 
    REFERENCES COUNTRY_TABLE(CNAME)

 --   CREATE VIEW dbo.user_joins
	--AS

	SELECT * FROM CATEGORY_LIST;

	SELECT * FROM PRODUCTS;

	SELECT * FROM COUNTRY_TABLE;

	ALTER TABLE CATEGORY_LIST ADD
	COUNTRY VARCHAR(25)

	ALTER TABLE 
    ADD COUNTRY VARCHAR(25)
    CONSTRAINT FK_Customer_Test_Drive 
    FOREIGN KEY (COUNTRY) 
    REFERENCES COUNTRY_TABLE(CNAME)

	ALTER TABLE CATEGORY_LIST
    ADD COUNTRY VARCHAR(25)
    --CONSTRAINT FK_Customer_Test_Drive 
    FOREIGN KEY (COUNTRY) 
    REFERENCES COUNTRY_TABLE(CNAME)

	--CREATE TABLE COUNTRY_TABLE
	--(
	--CID INT,
	--CNAME VARCHAR(25),
	--PRIMARY KEY(CID,CNAME)
	--);

	UPDATE CATEGORY_LIST SET COUNTRY=
	CASE CATG_ID
	WHEN 1 THEN 'India'
	WHEN 2 THEN 'Nepal'
	WHEN 3 THEN 'Pakistan'
	END
	WHERE CATG_ID IN (1,2,3)
	

	SELECT * FROM CATEGORY_LIST;
	-- ERROE --Column names in each table must be unique. Column name 'COUNTRY' in table 'CATEGORY_LIST' is specified more than once.

   -- ADD COUNTRY VARCHAR(25)
  --  
  	ALTER TABLE CATEGORY_LIST
	CONSTRAINT FK_Customer_Test_Drive 
    FOREIGN KEY (COUNTRY) 
    REFERENCES COUNTRY_TABLE(CNAME)

	ALTER TABLE CATEGORY_LIST
    ADD FOREIGN KEY (COUNTRY) 
	REFERENCES COUNTRY_TABLE(CNAME) 

	SELECT * FROM PRODUCTS;

	SELECT * FROM COUNTRY_TABLE;

	SELECT * FROM CATEGORY_LIST;

	SELECT * FROM COUNTRY_TABLE CN
	INNER JOIN CATEGORY_LIST C ON 
	CN.CNAME=C.COUNTRY 
	WHERE CID = 91;

	SELECT * FROM COUNTRY_TABLE CN 
	INNER JOIN CATEGORY_LIST C
	ON CN.CNAME=C.COUNTRY;

	SELECT COUNTRY FROM CATEGORY_LIST;

	SELECT P.PRO_NAME,P.PRO_PRICE,C.CATEGORY_NAME
	FROM  PRODUCTS P
	INNER JOIN CATEGORY_LIST C
	ON P.CATEGORY_ID=C.CATG_ID WHERE C.CATG_ID=2

	EXEC SP_RENAME 'CATEGORY_LIST.country','COUNTRY_ID','COLUMN'

	UPDATE CATEGORY_LIST SET COUNTRY_ID=
	CASE CATG_ID
	WHEN 1 THEN 91
	WHEN 2 THEN 92
	WHEN 3 THEN 977
	END
	WHERE CATG_ID IN (1,2,3)

	SELECT * FROM CATEGORY_LIST;

	SELECT * FROM COUNTRY_TABLE;

	SELECT * FROM CATEGORY_LIST C INNER JOIN COUNTRY_TABLE CN ON C.COUNTRY_ID=CN.CID;

	SELECT C.CATG_ID,CN.CNAME FROM CATEGORY_LIST C INNER JOIN COUNTRY_TABLE CN ON C.COUNTRY_ID=CN.CID WHERE CID=91

	SELECT * FROM CATEGORY_LIST C INNER JOIN COUNTRY_TABLE CN ON C.COUNTRY_ID=CN.CID WHERE CID=91

	SELECT * FROM PRODUCTS;

	SELECT * FROM CATEGORY_LIST;

	SELECT * FROM COUNTRY_TABLE;

	SELECT P.PRO_NAME,P.PRO_PRICE,C.CATEGORY_NAME,CN.CNAME 
	FROM ((PRODUCTS P INNER JOIN CATEGORY_LIST C 
	ON P.CATEGORY_ID=C.CATG_ID)
	INNER JOIN COUNTRY_TABLE CN
	ON CN.CID=C.COUNTRY_ID) WHERE CID=91;

	SELECT COUNT(*),P.PRO_NAME,P.PRO_PRICE,C.CATEGORY_NAME,CN.CNAME 
	FROM ((PRODUCTS P INNER JOIN CATEGORY_LIST C 
	ON P.CATEGORY_ID=C.CATG_ID)
	INNER JOIN COUNTRY_TABLE CN
	ON CN.CID=C.COUNTRY_ID) GROUP BY COUNT(*) HAVING CNAME='INDIA';